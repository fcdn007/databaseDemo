{% load staticfiles %}
<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <title>test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 引入bootstrap的css文件 -->
    <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.min.css' %}">

    <!-- 引入datatables的css文件 -->
    <link rel="stylesheet" href="{% static 'DataTables/datatables.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'Buttons/css/buttons.dataTables.min.css' %}">
    <link rel="stylesheet" href="{% static 'stylesheets/rowReorder.dataTables.min.css' %}">
    <link rel="stylesheet" href="{% static 'stylesheets/colReorder.dataTables.min.css' %}">
    <link rel="stylesheet" href="{% static 'stylesheets/fixedColumns.dataTables.min.css' %}">
    <link rel="stylesheet" href="{% static 'stylesheets/select.dataTables.min.css' %}">

</head>
<body>
<!-- bootstrap.js 依赖 jquery.js 和popper.js，因此在这里引入 -->
<script src="{% static 'jquery/jquery.min.js' %}"></script>
<script src="{% static 'popper/popper.min.js' %}"></script>
<!-- 引入bootstrap的js文件 -->
<script src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>
<!-- 引入datatables的js文件 -->
<script src="{% static 'js/pdfmake.min.js' %}"></script>
<script src="{% static 'js/vfs_fonts.js' %}"></script>
<script src="{% static 'DataTables/datatables.min.js' %}"></script>
<script src="{% static 'Buttons/js/dataTables.buttons.min.js' %}"></script>
<script src="{% static 'js/jszip.min.js' %}"></script>
<script src="{% static 'Buttons/js/buttons.colVis.min.js' %}"></script>
<script src="{% static 'Buttons/js/buttons.html5.min.js' %}"></script>
<script src="{% static 'js/dataTables.select.min.js' %}"></script>
<script src="{% static 'js/dataTables.rowReorder.min.js' %}"></script>
<script src="{% static 'js/dataTables.colReorder.min.js' %}"></script>
<script src="{% static 'js/dataTables.fixedColumns.min.js' %}"></script>
<script src="{% static 'js/jquery.cookie.min.js' %} "></script>
<div class="container-fluid">
    <table id="table_id" class="display">
        <thead>
        <tr>
            <th>索引</th>
            <th>样本编号</th>
            <th>姓名</th>
            <th>性别</th>
            <th>年龄</th>
            <th>住院号</th>
            <th>癌种</th>
            <th>分期</th>
            <th>诊断</th>
            <th>诊断备注</th>
            <th>采样日期</th>
            <th>离心日期</th>
            <th>医院编号</th>
            <th>科室</th>
            <th>血浆管数</th>
            <th>癌旁组织样本数量</th>
            <th>癌组织样本数量</th>
            <th>白细胞样本数量</th>
            <th>粪便样本数量</th>
            <th>寄送日期</th>
            <th>备注</th>
            <th>操作</th>
        </tr>
        </thead>
    </table>
</div>
</body>
<script>
    let csrftoken = $.cookie('csrftoken');

    function csrfSafeMethod(method) {
        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
    }

    $(document).ready(function () {
        let d = [
            {
                data: 'index',
                width: "1%",
                // 若想前端显示的不一样，则需要"render"函数
                'render': function (data, type, full, meta) {
                    return meta.row + 1 + meta.settings._iDisplayStart;
                }
            },
            {"data": "sample_id"},
            {"data": "name"},
            {"data": "gender"},
            {"data": "age"},
            {"data": "patientId"},
            {"data": "category"},
            {"data": "stage"},
            {"data": "diagnose"},
            {"data": "diagnose_others"},
            {"data": "sampling_date"},
            {"data": "centrifugation_date"},
            {"data": "hospital"},
            {"data": "department"},
            {"data": "plasma_num"},
            {"data": "adjacent_mucosa_num"},
            {"data": "cancer_tissue_num"},
            {"data": "WBC_num"},
            {"data": "stool_num"},
            {"data": "send_date"},
            {"data": "others"},
            {
                "data": null,
                "defaultContent": '<button type="button" class="btn btn-info">Edit</button>' + '&nbsp;&nbsp' +
                    '<button type="button" class="btn btn-danger">Delete</button>'
            }
        ];
        let table = $('#table_id').DataTable({
            "language": {
                "lengthMenu": "选择每页 _MENU_ 展示 ",
                "zeroRecords": "未找到匹配结果--抱歉",
                "info": "当前显示第 _PAGE_ 页结果，共 _PAGES_ 页",
                "infoEmpty": "没有数据",
                "search": "搜索",
                "infoFiltered": "(获取 _MAX_ 项结果)",
                "paginate": {
                    "first": "首页",
                    "previous": "上一页",
                    "next": "下一页",
                    "last": "末页"
                }
            },
            "scrollY": "5000px",
            "scrollCollapse": true,
            "scrollX": true,
            "pagingType": "full_numbers",
            fixedColumns: true,
            rowReorder: true,
            colReorder: true,
            searching: true,
            select: true,
            dom: 'lB<"clear">frtip',
            buttons: [
                {
                    text: '显示列', extend: 'colvis',
                    postfixButtons: ['colvisRestore'],
                    columnText: function (dt, idx, title) {
                        return (idx + 1) + ': ' + title;
                    }
                },
                {
                    extend: 'selectAll',
                    text: '全选'
                }, {
                    extend: 'selectRows',
                    text: '选择多行'
                }, {
                    extend: 'selectColumns',
                    text: '选择多列'
                }, {
                    extend: 'selectCells',
                    text: '选择多个单元格'
                }, {
                    extend: 'selectNone',
                    text: '取消当前选择'
                },
                {
                    extend: 'copy',
                    text: '复制到剪切板'
                }, {
                    extend: 'csv',
                    text: '输出到csv'
                }
            ],
            "lengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "全部"]],
            "serverSide": true,
            "processing": true,
            "ajax": {
                beforeSend: function (xhr, settings) {
                    if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                        xhr.setRequestHeader("X-CSRFToken", csrftoken);
                    }
                },
                "url": "{% url 'testp' %}",
                "type": "POST",
                "data": function (d) {
                    return $.extend({}, d, {
                        "sample_id": '19P1234567',
                    });
                }
            },
            "columns": d
        });
    })
</script>
</html>